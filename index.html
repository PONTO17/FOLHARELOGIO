<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro, Lista e ImpressÃ£o</title>
  <style>
    /* â€” todo o CSS permanece igual â€” */
    *{box-sizing:border-box;font-family:Arial, sans-serif;}
    body{margin:20px;background:#f9f9f9;}
    h2,h3,h4{margin:5px 0;}
    .container-form{width:100%;background:#fff;border:1px solid #ccc;padding:15px;margin-bottom:20px;}
    /* â€¦ (demais regras exatamente como antes) â€¦ */
  </style>
</head>
<body>

<h2>Cadastro e ImpressÃ£o</h2>

<script>
/* ===== CONFIG ===== */
const STORAGE_KEY = 'cadastros_ponto17';
const SCRIPT_URL  = 'https://script.google.com/macros/s/AKfycbw2B7te5-GXKqtyavhgDnbQ9PK_Qv1iC3L7rQ60YAUDOwf7qSmTAOLE7oyDRpSti0KwCQ/exec'; // âœ… seu link

/* ======= CARREGAR AO ABRIR ======= */
window.addEventListener('load', () => {
  carregarDoLocal();
  carregarDaPlanilha();         // tenta sincronizar onâ€‘line
});

/* â€”â€”â€” LocalStorage (mesmo de antes) â€”â€”â€” */
function salvarNoLocal(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(lerTabela())); }
function carregarDoLocal(){
  const d = localStorage.getItem(STORAGE_KEY);
  if(d) try{ preencherTabela(JSON.parse(d)); }catch(e){ console.error(e); }
}

/* â€”â€”â€” GoogleÂ Sheets â€”â€”â€” */
async function carregarDaPlanilha(){
  try{
    const r = await fetch(`${SCRIPT_URL}?action=list`);
    if(!r.ok) throw new Error(r.statusText);
    preencherTabela(await r.json());
  }catch(e){ console.warn('sem conexÃ£o com a planilha:', e.message); }
}
async function enviarParaPlanilha(obj){
  try{
    await fetch(SCRIPT_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(obj)
    });
  }catch(e){ console.error('falha ao enviar:', e.message); }
}

/* ======= RESTO DO JS (idÃªntico) ======= */
/* funÃ§Ãµes utilitÃ¡rias, create/edit cells, imprimirRegistro, etc. */
/* â€¦ cole aqui todo o bloco JS que vocÃª jÃ¡ tinha â€¦                */

/* -------- confirmarCadastro (apenas final) -------- */
function confirmarCadastro(){
  /* â€¦ gera linha na tabela exatamente como antes â€¦ */

  const registroObj = {
    numero  : row.cells[0].textContent,
    nome    : row.cells[1].textContent,
    telefone: row.cells[2].textContent,
    objetos : row.cells[3].textContent,
    entrada : row.cells[4].textContent,
    volta   : row.cells[5].textContent,
    valor   : row.cells[6].textContent,
    pagou   : paySelect.value,
    status  : stSelect.value,
    obs     : obs
  };
  enviarParaPlanilha(registroObj);   // ðŸ”— envia onâ€‘line
  salvarNoLocal();                   // ðŸ’¾ guarda offâ€‘line
}
</script>

<!-- ===== FORM, TABELA, FOLHA DE IMPRESSÃƒO â€” exatamente como antes ===== -->
<!-- (Tudo igual ao arquivo que vocÃª jÃ¡ tem; sÃ³ o JS acima foi alterado) -->
</body>
</html>
