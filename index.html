<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro, Lista e Impressão (Google Sheets Automático)</title>
  <style>
    *{box-sizing:border-box;font-family:Arial, sans-serif}
    body{margin:20px;background:#f9f9f9}
    h2,h3,h4{margin:5px 0}

    .container-form{width:100%;background:#fff;border:1px solid #ccc;
                    padding:15px;margin-bottom:20px}
    .container-form h3{margin-bottom:15px}
    .container-form label{display:block;margin-bottom:5px;font-weight:bold}
    .container-form input,.container-form textarea{width:100%;padding:8px;margin-bottom:10px}

    #search-container{display:none;background:#fff;border:1px solid #ccc;
                      padding:15px;margin-bottom:20px}

    .botao-nova-aba{position:fixed;right:10px;top:50px;padding:10px 15px;
                    font-weight:bold;cursor:pointer;background:#007BFF;color:#fff;
                    border:none;border-radius:4px;display:none}

    table{width:100%;border-collapse:collapse;margin-bottom:20px}
    table,th,td{border:1px solid #ccc}
    th,td{padding:8px;text-align:center}

    .linha-concluida{background:#ccffcc!important}

    .pay-bullet{display:inline-block;width:12px;height:12px;border-radius:50%;
                margin-left:5px;vertical-align:middle}

    .editing-input{width:95%;background:#fffbe2;border:1px solid #ccc}

    .radio-group{margin-bottom:10px}
    .radio-group span{font-weight:bold;margin-right:10px}
    .radio-group input[type="radio"]{display:none}
    .radio-group .radio-btn{display:inline-block;padding:8px 16px;margin-right:5px;
                            border:1px solid #ccc;border-radius:4px;background:#f0f0f0;
                            cursor:pointer;transition:.3s}
    .radio-group input[type="radio"]:checked + .radio-btn{
      background:#007BFF;color:#fff;border-color:#007BFF}

    .impressao{display:none;position:absolute;left:-99999px;top:-99999px}

    @media print{
      body *{visibility:hidden!important}
      .impressao,.impressao *{visibility:visible!important}
      .impressao{display:block!important;position:fixed!important;top:0;left:0;width:100%!important;background:#fff}
    }
  </style>
</head>
<body>

<h2>Cadastro e Impressão (Google Sheets Automático)</h2>

<!-- URL do Apps Script ATIVA -->
<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxGJjSqGxx10bDDRS5l1PloX-xuPmotTxQ704cc1j9v_VwKC5Y0i_E0-5Nmta_-LFzMnQ/exec";
</script>

<!-- ======= FORMULÁRIO ======= -->
<div class="container-form">
  <h3>Cadastro</h3>
  <label>Nome:</label><input id="cad-nome" placeholder="Ex: Marcos Antônio">
  <label>Telefone:</label><input id="cad-telefone" placeholder="Ex: (xx) 99999-9999">
  <label>Objetos:</label><input id="cad-servico" placeholder="Ex: Relógio (marca) dourado">
  <label>DESCRIÇÃO DO SERVIÇO:</label><textarea id="cad-obs" rows="3"></textarea>
  <label>Quantos dias úteis?</label><input id="cad-dias-uteis" type="number" placeholder="Ex: 5">

  <div class="radio-group">
    <span>É orçamento?</span>
    <input type="radio" id="orcamentoSim" name="orcamento" value="sim">
    <label for="orcamentoSim" class="radio-btn" onclick="toggleValorField()">SIM</label>
    <input type="radio" id="orcamentoNao" name="orcamento" value="nao" checked>
    <label for="orcamentoNao" class="radio-btn" onclick="toggleValorField()">NÃO</label>
  </div>

  <div id="cad-valor-field">
    <label>Valor (R$):</label><input id="cad-valor" placeholder="Ex: 150,00">
  </div>

  <button onclick="confirmarCadastro()">Confirmar & Imprimir</button>
  <button id="btnLimpar" onclick="limparCadastro()">Limpar</button>
</div>

<button onclick="toggleSearch()">BUSCAR SERVIÇO</button>
<div id="search-container">
  <h3>Buscar</h3>
  <input id="searchTerm"><button onclick="searchServices()">Buscar</button>
</div>

<h3>Lista de Cadastros</h3>
<table id="lista-cadastros">
  <thead>
    <tr>
      <th>Nº</th><th>Nome</th><th>Telefone</th><th>Objetos</th><th>Entrada</th>
      <th>Volta</th><th>Valor (R$)</th><th>Pagou?</th><th>Status</th><th>Ações</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button class="botao-nova-aba" id="btnNovaAba" onclick="abrirFolhaEmNovaAba()">Abrir Folha de Impressão</button>

<!-- Folha de impressão (igual ao seu original) -->
<div class="impressao" id="folha-impressao">
  <!-- … conteúdo idêntico ao original … -->
</div>

<!-- ============ JAVASCRIPT (igual ao seu, só mudou salvarNoGoogle) ============ -->
<script>
window.addEventListener('load', carregarDoGoogle);
let registroCount = 1;

/* ===== helpers e funções (todo o resto do seu código permanece IGUAL) ===== */
/* toggleValorField, formatarValor, parseDate, confirmarCadastro, etc.        */
/* (copiados 1:1 do arquivo que você enviou)                                  */

/* ---------- SALVAR NO GOOGLE (só aqui mudou) ---------- */
async function salvarNoGoogle(){
  try{
    const cadastros = lerTabelaCadastros();
    const resp = await fetch(SCRIPT_URL,{
      method:'POST',
      body: JSON.stringify(cadastros)          // <= sem headers
    });
    const js = await resp.json();
    if(js.ok) console.log("Salvo na planilha com sucesso!");
    else{console.error(js);alert("Erro do script: "+JSON.stringify(js));}
  }catch(e){
    console.error(e);alert("Falha ao salvar no Google: "+e);
  }
}

/* ---------- carregarDoGoogle, imprimirRegistro, etc. (originais) ---------- */
/* … copie aqui exatamente como estavam no seu código inicial … */
</script>
</body>
</html>
